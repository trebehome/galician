$("#changeLang").change(()=>{window.location=$("#changeLang").val()}),document.getElementsByTagName("nav")[0].classList.add("border-bottom"),window.pageYOffset===0&&document.getElementsByTagName("nav")[0].classList.remove("border-bottom"),document.onscroll=()=>{if(window.pageYOffset===0){document.getElementsByTagName("nav")[0].classList.remove("border-bottom");return}document.getElementsByTagName("nav")[0].classList.add("border-bottom")},document.getElementById("menu-button").onclick=()=>{let e=document.getElementById("menu-icon");if(e.classList.contains("open")){e.classList.remove("open");return}e.classList.add("open")};function setAPIkeyStatus(){let e=localStorage.getItem("apiKey");e&&$("#apiKey").val(e)}function setNewAPIkey(){let e=$("#apiKey").val().trim();e&&e!==localStorage.getItem("apiKey")&&localStorage.setItem("apiKey",e)}function clearTextBox(){$("#inputText").val(""),$("#outputText").val(""),$("#outputTranscription").val("")}[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(e=>new bootstrap.Tooltip(e)),setAPIkeyStatus(),$("#apiKey").change(setNewAPIkey),$("#clearButton").click(clearTextBox),$("#clipboard-tkonline").click(copyToClipboard);const recordStart=document.querySelector("#recordStartButton"),recordStop=document.querySelector("#recordEndButton");let mediaRecorder=null,chunks=[];recordStart.onclick=()=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{mediaRecorder===null&&(mediaRecorder=new MediaRecorder(e,{audioBitsPerSecond:16e3}),mediaRecorder.onstop=()=>{const e=new Blob(chunks,{type:"audio/wav; codecs=0"});chunks=[],document.querySelector("audio").src=URL.createObjectURL(e),audioTranscribe(e)},mediaRecorder.ondataavailable=e=>{chunks.push(e.data)}),mediaRecorder.start(),$("#recordStartButton").prop("disabled",!0),$("#recordEndButton").prop("disabled",!1)},e=>console.error("Error: "+e))},recordStop.onclick=()=>{mediaRecorder.stop(),$("#recordStartButton").prop("disabled",!1),$("#recordEndButton").prop("disabled",!0)};function blobToBase64(e){return new Promise(t=>{const n=new FileReader;n.onloadend=()=>t(n.result),n.readAsDataURL(e)})}async function audioTranscribe(e){const s="https://api.trebesrv.com/transcription/v1/online/transcribe";$("#loading_file").css("display","block");let t=await blobToBase64(e),n=t.substr(t.indexOf(",")+1);if(n!==""){let e=$("#model").val(),t=localStorage.getItem("apiKey").split("_"),o=t.shift(),i={method:"POST",headers:{"Content-Type":"application/json",apikey:o},body:JSON.stringify({languagemodel:e,audio:n})};fetch(s,i).then(e=>e.json()).then(e=>{$("#outputTranscription").val(e.text||e.message||e.error),$("#loading_file").css("display","none")}).catch(e=>{$("#outputTranscription").val(e)})}}function copyToClipboard(){let e=$("#outputTranscription");e.select(),navigator.clipboard.writeText(e.val())}